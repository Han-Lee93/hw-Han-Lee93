---
title: "HW04"
author: "Han Lee"
date: "3/5/2021"
output:
    html_document: default
    github_document: default
    theme: paper
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(here)
library(dplyr)
library(tidyr)
library(tibble)
library(ggplot2)
library(tidyverse)
library(gridExtra)
library(reshape2)
library(kableExtra)
library(ggdist)
```

```{r}
dat <- read_csv(here::here("raw_data","RepeatedExposureReverseRdata.csv"),
                col_types = cols(
                  `F/L/Sex` = col_character(),
                  ID = col_double(),
                  TrialType = col_character(),
                  `Trial#` = col_double(),
                  `RunPosition#` = col_double(),
                  `Run#` = col_double(),
                  ConditionType = col_character(),
                  Condition = col_character(),
                  RT = col_double(),
                  Error = col_double(),
                  TotalError = col_double(),
                  RepeatedError = col_double(),
                  Target = col_character(),
                  Globality = col_character(),
                  RunType = col_character(),
                  StimuliType = col_character()
                  ),
                  na=c("","NA")
                ) %>% 
    filter(TrialType == "Experiment", ConditionType == "Critical", Error == "0", (RT>=50 & RT<= 1999)) 

write_csv(dat,
          here::here("HW04_data.csv")
          )

```

```{r}
graph = ggplot(dat) +
  aes(RT) +
  geom_histogram(binwidth = 50)

ggsave(here::here("Plots", "RTdististribution.pdf"), graph)

graph

```

```{r}
summarytable = dat %>%
  group_by (ID, Condition, `RunPosition#`) %>% 
  summarize(across(c(RT),
                     list(Mu = ~ mean(.x,
                                      na.rm = TRUE
                                     ),
                         Sigma = ~ sd(.x,
                                      na.rm = TRUE
                                     ),
                         n = ~ n()
                         )
                  )
            )
write_csv(summarytable,
          here::here("Summaries", "Mean_by_condition-id-conditiontype.csv")
          )

kable(summarytable) %>% 
  kable_styling(full_width = F)

```
